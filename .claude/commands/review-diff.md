# review-diff

mainブランチとの差分と新しいファイルをレビューします。

## Prompt

以下の手順を実行してください。

1. `git diff main` でmainブランチとの差分を確認
2. `git status` で新しいファイル(untracked files)を確認
3. 新しいファイルがあれば、それらを読み取る
4. 以下の観点からコードレビューを実施
   - アーキテクチャの適切性
   - バグや潜在的な問題
   - パフォーマンスの問題
   - セキュリティの懸念
   - コードスタイルとベストプラクティス
   - メモリリークやリソースリークの可能性
   - 型安全性（該当する場合）
   - エラーハンドリング
   - プロジェクト固有のガイドラインへの準拠（CLAUDE.mdがあれば参照）

## レビュー結果の出力形式

レビュー結果は以下の形式でまとめてください。各項目には詳細な説明を含めます。

### 変更概要

変更内容の概要を記載

### 良い点

良い点があれば記載

### 指摘事項

すべての問題・改善提案を番号付きで出力します。各項目には以下を含めます。
- ファイルパスと行番号
- 問題の種類（重大/改善提案/軽微）
- 問題の詳細説明（なぜ問題なのか）
- 推奨される修正内容（具体的なコード例があれば含める）

形式：
```
[1] 重大 - path/to/file.ext:42
    問題: 問題の概要
    理由: なぜこれが問題なのかの説明
    修正案: 具体的な修正方法

[2] 改善提案 - path/to/another.ext:15
    問題: 問題の概要
    理由: なぜこれが問題なのかの説明
    修正案: 具体的な修正方法
```

## 修正項目の選択

レビュー完了後、AskUserQuestion ツールを使用して修正したい項目をユーザーに選択させてください。

設定
- multiSelect: false
- header: "Fix"
- question: "修正したい項目を選択してください（Otherで番号をカンマ区切りで指定可能）"
- options:
  - label: "すべて修正", description: "検出されたすべての問題を修正します"
  - label: "修正しない", description: "このままレビュー結果を確認するのみで終了します"

ユーザーが "Other" を選択した場合、入力された番号（例: "1,3,5" や "1-3" や "1"）をパースして該当項目のみ修正する。

## 修正の実行

ユーザーが修正項目を選択したら、以下を実行します。

1. 選択された項目について、該当ファイルを読み取る
2. 各問題に対して具体的な修正を実行する
3. 修正完了後、変更内容を簡潔に報告する

「修正しない」が選択された場合は、そのまま終了する。
